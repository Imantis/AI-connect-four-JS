$(document).ready(function(){let l="player";const s=6,o=7;let c;var n=[],u=[];function v(t,e){let a=0,r=!1,i=$("."+t);return n.forEach(e=>{if(e.forEach(e=>u[e]!==t?(a=0,null):void a++),4<=a)return r=!0,null}),r&&"future"!==e&&(i.first().hasClass("active-player")?alert("Player win!"):i.first().hasClass("active-ai")&&alert("AI win!"),$(".element").addClass("active")),r}function t(e){let t=e.data("element"),a=e,r;if(t>=s*o-s)return a;for(;t<=o*s;)if(t+=o,r=a,a=$("[data-element="+t+"]"),!a.length||a.hasClass("active"))return r;return"Error"}function a(){var e=function(){console.log("Turn status on start "+l);let e=[],t=[];t=function(e){let t,a,r,i,n,l;for(t=1;t<=o;t++)if(!$("[data-element="+t+"]").hasClass("active"))for(l=[t],n=f(l),e["lev_1_turn_"+t]={weight:n,turn_combination:l,lev:1},a=1;a<=o;a++)for($("[data-element="+a+"]").hasClass("active")||(l=[t,a],n=f(l),e["lev_2_turn_"+t+"_"+a]={weight:n,turn_combination:l,lev:2}),r=1;r<=o;r++)for($("[data-element="+r+"]").hasClass("active")||(l=[t,a,r],n=f(l),e["lev_3_turn_"+t+"_"+a+"_"+r]={weight:n,turn_combination:l,lev:3}),i=1;i<=o;i++)$("[data-element="+i+"]").hasClass("active")||(l=[t,a,r,i],n=f(l),e["lev_4_turn_"+t+"_"+a+"_"+r+"_"+i]={weight:n,turn_combination:l,lev:4});return e}(t);let a,r;for(a in console.log(u),console.log(t),t){if(r=t[a],1===r.lev&&1===r.weight){e=r.turn_combination;break}if(1===r.lev&&0===r.weight){e=r.turn_combination;break}if(2===r.lev&&1===r.weight){e=r.turn_combination;break}if(2===r.lev&&0===r.weight){e=r.turn_combination;break}if(3===r.lev&&1===r.weight){e=r.turn_combination;break}if(3===r.lev&&0===r.weight){e=r.turn_combination;break}}return e[0]?(console.log("AI MOVE!"),e[0]):3}();c=t($("[data-element="+e+"]")),"Error"===c?alert(c):(c.addClass("active-ai").addClass("active"),l="player",v(u[c.attr("data-element")]="active-ai"))}function f(e){var t=$.extend(!0,{},l),a=JSON.parse(JSON.stringify(u));let r,i,n=0;return e.forEach(e=>{c=function(e){let t=e,a;if(t>=s*o-s)return t;for(;t<=o*s;)if(a=t,t+=o,"active-ai"===u[t]||"active-player"===u[t]||void 0===u[t])return a;return"Error"}(e),"Error"===c||(r=!1,i=!1,l="player"===l?(u[c]="active-player",r=v("active-player","future"),"ai"):(u[c]="active-ai",i=v("active-ai","future"),"player"),n=!0===i?1:!0===r?-1:0)}),l=$.extend(!0,{},t),u=a,n}!function(){let e,t;for(e=0;e<s;e++)t=e*o,n.push([t+1,t+2,t+3,t+4]),n.push([t+2,t+3,t+4,t+5]),n.push([t+3,t+4,t+5,t+6]),n.push([t+4,t+5,t+6,t+7]);for(e=1;e<=o;e++)t=e,n.push([t,t+o,t+2*o,t+3*o]),n.push([t+o,t+2*o,t+3*o,t+4*o]),n.push([t+2*o,t+3*o,t+4*o,t+5*o]);for(e=1;e<=o-3;e++)t=e,n.push([t,t+(o+1),t+(2*o+2),t+(3*o+3)]),n.push([t+o,t+(2*o+1),t+(3*o+2),t+(4*o+3)]),n.push([t+2*o,t+(3*o+1),t+(4*o+2),t+(5*o+3)]);for(e=4;e<=o;e++)t=e,n.push([t,t+(o-1),t+(2*o-2),t+(3*o-3)]),n.push([t+o,t+(2*o-1),t+(3*o-2),t+(4*o-3)]),n.push([t+2*o,t+(3*o-1),t+(4*o-2),t+(5*o-3)]);console.log(n)}(),$(".element").each(function(e){$(this).attr("data-element",e+1),$(this).append(e+1),u[e+1]="empty"}),$("[data-restart-game-first-player]").click(function(){alert("Game restarted. First player step!"),l="player",$(".active").removeClass("active-player").removeClass("active-ai").removeClass("active")}),$("[data-restart-game-first-ai]").click(function(){alert("Game restarted. First AI step!"),l="ai",$(".active").removeClass("active-player").removeClass("active-ai").removeClass("active"),a()}),$(".element").click(function(){if(!$(this).hasClass("active")){let e=!1;"player"===l&&(c=t($(this)),"Error"===c?alert(c):(c.addClass("active-player").addClass("active"),u[c.attr("data-element")]="active-player",l="ai",e=v("active-player")),e||a())}})});